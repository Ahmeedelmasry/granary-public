import{I as Y,r as $,o as q,f as m,k as y,l as w,q as o,s,m as e,C as l,D as C,L,v as D,t as d,F as k,B as G,E as P,z as R,H as U,G as A}from"./entry.0a484266.js";import{g as z}from"./granary.877d6f42.js";import{s as E}from"./supplier.ec4415e2.js";import{h as T}from"./moment.a9aaa855.js";import{c as B,r as N,u as H}from"./index.28147b1b.js";import{V as W,a as J}from"./VSkeletonLoader.ec353db9.js";import{s as K}from"./supplier_payments.5cea4346.js";const O={class:"supplierPaymentReportFilter"},Q={class:"field_container"},X=e("label",{for:"supplierId"},"اختر المورد",-1),Z={class:"input_parent position-relative"},ee=e("div",{class:"d-flex ps-4 pe-2 py-2",style:{"justify-content":"space-between"}},[e("span",null,"الاسم"),e("span",null,"الكود")],-1),te={key:0,class:"err_msg"},se={class:"field_container"},le=e("label",{for:"granaryId"},"اختر الصومعة",-1),ae={class:"input_parent position-relative"},oe={key:0,class:"err_msg"},ne={class:"field_container",dir:"rtl"},ie=e("label",{for:"FromDate"},"من",-1),re={class:"input_parent position-relative"},de=["disabled"],ue={class:"field_container",dir:"rtl"},pe=e("label",{for:"ToDate"},"الي",-1),ce={class:"input_parent position-relative"},me=["disabled"],_e={__name:"Filter",props:["loading"],emits:["filterData"],setup(t,{emit:v}){const u=z(),_=E(),{granaries:b}=Y(u),{suppliers:F}=Y(_),a=$({supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,ToDate:null}),p=$({supplierId:{required:B.withMessage("هذا الحقل مطلوب",N)},granaryId:{required:B.withMessage("هذا الحقل مطلوب",N)}});let c=H(p,a);const S=async()=>{if(await c.value.$validate()){const i={supplierId:a.value.supplierId,granaryId:a.value.granaryId,creationFromDate:a.value.creationFromDate?T(a.value.creationFromDate).format("DD/MM/YYYY"):null,creationToDate:a.value.creationToDate?T(Date.now(a.value.creationToDate)+864e5).format("DD/MM/YYYY"):null,FromDate:a.value.FromDate?T(a.value.FromDate).format("DD/MM/YYYY"):null,ToDate:a.value.ToDate?T(a.value.ToDate).format("DD/MM/YYYY"):null};v("filterData",i)}};return q(()=>{u.doGetGranaries(0,1e4),_.doGetSuppliers(0,1e4)}),(x,i)=>{const g=m("v-list-item"),f=m("v-autocomplete"),I=m("v-icon"),h=m("v-col"),r=m("v-btn"),j=m("v-row");return y(),w("div",O,[o(j,{dir:"rtl",class:"pt-0"},{default:s(()=>[o(h,{cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[e("div",Q,[X,e("div",Z,[o(f,{"item-title":"name","item-value":"id",items:l(F).content,transition:"slide-y-transition",variant:"outlined","hide-details":"",modelValue:l(a).supplierId,"onUpdate:modelValue":i[0]||(i[0]=n=>l(a).supplierId=n),disabled:t.loading,placeholder:"اختر المورد",class:C(l(c).$errors.find(n=>n.$property=="supplierId")?"err_field":""),name:"supplier",id:"supplier","custom-filter":(n,M,V)=>V.title.toString().includes(M)||V.value.toString().includes(M)},{"prepend-item":s(()=>[ee]),item:s(({props:n,item:M})=>[e("div",L(n,{class:"d-flex select_slot",style:{"justify-content":"space-between"}}),[o(g,null,{default:s(()=>[D(d(M.raw.name),1)]),_:2},1024),o(g,null,{default:s(()=>[D(d(M.raw.id),1)]),_:2},1024)],16)]),_:1},8,["items","modelValue","disabled","class","custom-filter"]),o(I,{class:"position-absolute"},{default:s(()=>[D("mdi-account-cowboy-hat")]),_:1})]),l(c).$errors.find(n=>n.$property=="supplierId")?(y(),w("span",te,d(l(c).$errors.find(n=>n.$property=="supplierId").$message),1)):k("",!0)])]),_:1}),o(h,{cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[e("div",se,[le,e("div",ae,[o(f,{"item-title":"name","item-value":"id",items:l(b).content,transition:"slide-y-transition",variant:"outlined",disabled:t.loading,"hide-details":"",modelValue:l(a).granaryId,"onUpdate:modelValue":i[1]||(i[1]=n=>l(a).granaryId=n),placeholder:"اختر الصومعة",class:C(l(c).$errors.find(n=>n.$property=="granaryId")?"err_field":"")},null,8,["items","disabled","modelValue","class"]),o(I,{class:"position-absolute"},{default:s(()=>[D("mdi-store-24-hour")]),_:1})]),l(c).$errors.find(n=>n.$property=="granaryId")?(y(),w("span",oe,d(l(c).$errors.find(n=>n.$property=="granaryId").$message),1)):k("",!0)])]),_:1}),o(h,{cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[e("div",ne,[ie,e("div",re,[G(e("input",{type:"date",name:"FromDate",id:"FromDate",disabled:t.loading,"onUpdate:modelValue":i[2]||(i[2]=n=>l(a).FromDate=n),style:{"padding-right":"0 !important"}},null,8,de),[[P,l(a).FromDate]]),o(I,{class:"position-absolute"},{default:s(()=>[D("mdi-calendar")]),_:1})])])]),_:1}),o(h,{cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[e("div",ue,[pe,e("div",ce,[G(e("input",{type:"date",name:"ToDate","onUpdate:modelValue":i[3]||(i[3]=n=>l(a).ToDate=n),disabled:t.loading,id:"ToDate",style:{"padding-right":"0 !important"}},null,8,me),[[P,l(a).ToDate]]),o(I,{class:"position-absolute"},{default:s(()=>[D("mdi-calendar")]),_:1})])])]),_:1}),o(h,{cols:"12",sm:"6",md:"4",lg:"3",style:{display:"flex","align-items":"flex-end"},class:"pt-0"},{default:s(()=>[o(r,{color:"blue",width:"100",height:"40",elevation:"0",onClick:S,class:"font-weight-bold",style:{"margin-bottom":"2px"},disabled:t.loading},{default:s(()=>[D("بحث")]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},ge=_e;const De={key:0,class:"dues_supplier_payments"},ve={class:"w-100 text-right",dir:"rtl",style:{border:"1px solid rgb(179, 179, 179)","border-radius":"12px",padding:"13px",background:"#f0f0f0ba"}},fe=e("th",{class:"pb-2"},"اسم المورد:",-1),be={class:"pb-2"},ye=e("th",{class:"pb-2"},"اسم الصومعة:",-1),he={class:"pb-2"},$e=e("th",{class:"pb-2"},"المنتج:",-1),Se={class:"pb-2"},xe=e("th",null,"الكمية الموردة:",-1),Ie=e("th",null,"اجمالي مبلغ التوريد:",-1),we=e("tr",null,null,-1),Fe={__name:"SupplierData",props:["supplierDues","selectedSupplier"],setup(t){return(v,u)=>t.selectedSupplier?(y(),w("div",De,[e("table",ve,[e("tbody",null,[e("tr",null,[fe,e("td",be,d(t.selectedSupplier&&t.selectedSupplier.supplier?t.selectedSupplier.supplier.name:""),1),ye,e("td",he,d(t.selectedSupplier&&t.selectedSupplier.granary?t.selectedSupplier.granary.name:""),1)]),e("tr",null,[$e,e("td",Se,d(t.supplierDues.productName),1),xe,e("td",null,d(t.supplierDues.totalAmount),1)]),e("tr",null,[Ie,e("td",null,d(Math.round(t.supplierDues.totalPriceAfterDiscount)),1)]),we])])])):k("",!0)}},Me=Fe,Te={class:"dashboard_banners_listing"},Ye={class:"page_toolbar d-flex align-center justify-space-between"},ke={class:"toolbar_btns"},Ve=e("span",{class:"d-none"},null,-1),Ce=e("div",null,"لايوجد بيانات",-1),Ge={__name:"SupplierDues",props:["supplierDues","loading","suppliers","granaries","selectedSupplier"],emits:["regetItems","filterData"],setup(t,{emit:v}){const u=$(1),_=$(1e3),b=$([{title:"رقم",key:"index"},{title:"كمية التوريد",key:"totalClearWeight"},{title:"قيمة التوريد",key:"totalAfterDiscount"},{title:"تاريخ التوريد",key:"date"}]),F=[{title:"الرئيسية",disabled:!1,to:{name:"index"}},{title:"التقارير",to:{name:"reports"}},{title:"تقرير مستحقات الموردين",disabled:!0}];return R(()=>u.value,a=>{v("regetItems",{page:a,limit:_.value})}),R(()=>_.value,a=>{v("regetItems",{page:u.value,limit:a})}),(a,p)=>{const c=m("v-icon"),S=m("v-btn"),x=m("v-breadcrumbs"),i=ge,g=m("v-col"),f=Me,I=m("v-row"),h=m("v-container");return y(),w("div",Te,[e("div",Ye,[e("div",ke,[o(S,{width:"20",size:"sm",elevation:"0",color:"transparent"},{default:s(()=>[o(c,{color:"white",size:"25"},{default:s(()=>[D("mdi-printer")]),_:1})]),_:1})]),o(x,{items:F,dir:"rtl",class:"pa-0 mb"},{title:s(({item:r})=>[D(d(r.title.toUpperCase()),1)]),_:1})]),o(h,{class:"page_container",fluid:""},{default:s(()=>[t.supplierDues?(y(),U(I,{key:0,class:"px-4 mt-1"},{default:s(()=>[o(g,{cols:"12",class:"px-0 py-0"},{default:s(()=>[o(i,{class:"mb-7",loading:t.loading,onFilterData:p[0]||(p[0]=r=>v("filterData",r))},null,8,["loading"])]),_:1}),t.supplierDues&&t.supplierDues.invoices?(y(),U(g,{key:0,cols:"12",class:"px-0 pt-0 mb-2"},{default:s(()=>[o(f,{supplierDues:t.supplierDues,selectedSupplier:t.selectedSupplier},null,8,["supplierDues","selectedSupplier"])]),_:1})):k("",!0),o(g,{cols:"12",class:"section_container dashboard_table pa-0"},{default:s(()=>[o(l(W),{headers:l(b),items:t.supplierDues&&t.supplierDues.invoices&&t.supplierDues.invoices.content?t.supplierDues.invoices.content:[],loading:t.loading,"items-per-page":l(_),"onUpdate:itemsPerPage":p[1]||(p[1]=r=>A(_)?_.value=r:null),page:l(u),"onUpdate:page":p[2]||(p[2]=r=>A(u)?u.value=r:null),"items-length":t.supplierDues.totalElements?t.supplierDues.totalElements:0,"no-data-text":"لايوجد بيانات","show-current-page":""},{bottom:s(()=>[Ve]),loading:s(()=>[o(l(J),{type:"table-row@4"})]),"item.index":s(({item:r})=>[D(d(r.index+1),1)]),"item.totalAfterDiscount":s(({item:r})=>[D(d(Math.ceil(r.selectable.totalAfterDiscount)),1)]),"item.date":s(({item:r})=>[e("p",null,d(l(T)(r.selectable.date).format("DD/MM/YYYY")),1)]),"no-data":s(()=>[Ce]),_:1},8,["headers","items","loading","items-per-page","page","items-length"])]),_:1})]),_:1})):k("",!0)]),_:1})])}}},Pe=Ge,Re={class:"dashboard_tests_page mb-10"},je={__name:"index",setup(t){const v=K(),u=E(),_=z(),{supplierDues:b}=Y(v),{granaries:F}=Y(_),{suppliers:a}=Y(u),p=$(!1),c=$({supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,ToDate:null}),S=async(x,i,g)=>{p.value=!0,c.value=g||{supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,ToDate:null},await v.doGetSupplierDues(x-1,i,c.value),p.value=!1};return q(()=>{b.value=[],u.doGetSuppliers(0,1e4),_.doGetGranaries(0,1e4)}),(x,i)=>{const g=Pe;return y(),w("div",Re,[o(g,{supplierDues:l(b),loading:l(p),granaries:l(F).content,suppliers:l(a).content,selectedSupplier:l(b).invoices?l(b).invoices.content[0]:{},onRegetItems:i[0]||(i[0]=f=>S(f.page,f.limit)),onFilterData:i[1]||(i[1]=f=>S(1,1e3,f))},null,8,["supplierDues","loading","granaries","suppliers","selectedSupplier"])])}}};export{je as default};
