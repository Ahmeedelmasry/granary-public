import{J as F,r as I,c as U,o as N,f as p,k as T,l as $,q as s,s as n,m as t,C as l,M as E,v,t as i,B as P,E as C,z as S,H as L,I as j,G as z,F as G}from"./entry.9ac21750.js";import{g as R}from"./granary.552dc71b.js";import{s as B}from"./supplier.33ca5a1d.js";import{p as q}from"./products.a76212ab.js";import{h as W}from"./moment.a9aaa855.js";import{V as H,a as J}from"./VSkeletonLoader.f41b8ad8.js";import{i as O}from"./invoices.989a2bdd.js";const K={class:"supplierPaymentReportFilter"},Q={class:"field_container"},X=t("label",{for:"supplierId"},"اختر المورد",-1),Z={class:"input_parent position-relative"},tt=t("div",{class:"d-flex ps-4 pe-2 py-2",style:{"justify-content":"space-between"}},[t("span",null,"الاسم"),t("span",null,"الكود")],-1),et={class:"field_container"},ot=t("label",{for:"granaryId"},"اختر الصومعة",-1),lt={class:"input_parent position-relative"},nt={class:"field_container"},st=t("label",{for:"productId"},"المنتج",-1),at={class:"input_parent position-relative"},it={class:"field_container"},dt=t("label",{for:"productTypeId"},"الفرز",-1),rt={class:"input_parent position-relative"},ct={class:"field_container"},ut=t("label",{for:"creationFromDate"},"من",-1),pt={class:"input_parent position-relative"},mt=["disabled"],_t={class:"field_container"},vt=t("label",{for:"creationToDate"},"الي",-1),gt={class:"input_parent position-relative"},ft=["disabled"],bt={__name:"Filter",props:["loading"],emits:["filterData"],setup(r,{emit:y}){const g=R(),m=B(),_=q(),{granaries:k}=F(g),{suppliers:w}=F(m),{products:D}=F(_),o=I({supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,productId:null,productTypeId:null,ToDate:null}),c=U(()=>o.value.productId?o.value.productId.typePriceList:[]),d=()=>{const u={supplierId:o.value.supplierId,granaryId:o.value.granaryId,productId:o.value.productId?o.value.productId.id:null,productTypeId:o.value.productTypeId?o.value.productTypeId.id:null,FromDate:o.value.creationFromDate?W(o.value.creationFromDate).format("DD/MM/YYYY"):null,ToDate:o.value.creationToDate?W(Date.now(o.value.creationToDate)+864e5).format("DD/MM/YYYY"):null};y("filterData",u)};return N(()=>{g.doGetGranaries(0,1e4),_.doGetProducts(0,1e4),m.doGetSuppliers(0,1e4)}),(u,a)=>{const f=p("v-list-item"),x=p("v-autocomplete"),b=p("v-icon"),h=p("v-col"),M=p("v-btn"),Y=p("v-row");return T(),$("div",K,[s(Y,{dir:"rtl",class:"pt-0"},{default:n(()=>[s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"pt-0"},{default:n(()=>[t("div",Q,[X,t("div",Z,[s(x,{"item-title":"name","item-value":"id",items:l(w).content,transition:"slide-y-transition",variant:"outlined","hide-details":"",modelValue:l(o).supplierId,"onUpdate:modelValue":[a[0]||(a[0]=e=>l(o).supplierId=e),a[1]||(a[1]=e=>u.supplierFound?u.supplierFound=!1:!1)],"auto-select-first":"",disabled:r.loading,placeholder:"اختر المورد",name:"supplier",id:"supplier","custom-filter":(e,V,A)=>A.title.toString().includes(V)||A.value.toString().includes(V)},{"prepend-item":n(()=>[tt]),item:n(({props:e,item:V})=>[t("div",E(e,{class:"d-flex select_slot",style:{"justify-content":"space-between"}}),[s(f,null,{default:n(()=>[v(i(V.raw.name),1)]),_:2},1024),s(f,null,{default:n(()=>[v(i(V.raw.id),1)]),_:2},1024)],16)]),_:1},8,["items","modelValue","disabled","custom-filter"]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-account-cowboy-hat")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:n(()=>[t("div",et,[ot,t("div",lt,[s(x,{"item-title":"name","item-value":"id",items:l(k).content,transition:"slide-y-transition",variant:"outlined",disabled:r.loading,"hide-details":"",modelValue:l(o).granaryId,"onUpdate:modelValue":a[2]||(a[2]=e=>l(o).granaryId=e),placeholder:"اختر الصومعة"},null,8,["items","disabled","modelValue"]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-store-24-hour")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:n(()=>[t("div",nt,[st,t("div",at,[s(x,{"return-object":"",items:l(D).content,"item-title":"name","item-value":"id",name:"productId",id:"productId",modelValue:l(o).productId,"onUpdate:modelValue":[a[3]||(a[3]=e=>l(o).productId=e),a[4]||(a[4]=e=>l(o).productTypeId=null)],variant:"outlined",placeholder:"اختر المنتج","hide-details":""},null,8,["items","modelValue"]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-basket")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:n(()=>[t("div",it,[dt,t("div",rt,[s(x,{"return-object":"",items:l(c),"item-title":"productType.name","item-value":"id",variant:"outlined",name:"productTypeId",id:"productTypeId","no-data-text":"لايوجد بيانات",modelValue:l(o).productTypeId,"onUpdate:modelValue":a[5]||(a[5]=e=>l(o).productTypeId=e),"hide-details":"",placeholder:"اختر الفرز"},null,8,["items","modelValue"]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-sitemap ")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:n(()=>[t("div",ct,[ut,t("div",pt,[P(t("input",{type:"date",name:"creationFromDate",disabled:r.loading,id:"creationFromDate","onUpdate:modelValue":a[6]||(a[6]=e=>l(o).creationFromDate=e),style:{"padding-right":"0 !important"}},null,8,mt),[[C,l(o).creationFromDate]]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-calendar")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:n(()=>[t("div",_t,[vt,t("div",gt,[P(t("input",{type:"date",name:"creationToDate",id:"creationToDate",disabled:r.loading,"onUpdate:modelValue":a[7]||(a[7]=e=>l(o).creationToDate=e),style:{"padding-right":"0 !important"}},null,8,ft),[[C,l(o).creationToDate]]),s(b,{class:"position-absolute"},{default:n(()=>[v("mdi-calendar")]),_:1})])])]),_:1}),s(h,{cols:"12",sm:"6",md:"4",lg:"3",class:"pb-1",style:{display:"flex","align-items":"flex-end"}},{default:n(()=>[s(M,{color:"blue",width:"100",height:"40",elevation:"0",onClick:d,class:"font-weight-bold",disabled:r.loading},{default:n(()=>[v("بحث")]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},ht=bt;const yt={class:"dashboard_banners_listing"},Dt={class:"page_toolbar d-flex align-center justify-space-between"},It={class:"toolbar_btns"},xt=t("h1",{dir:"rtl",class:"my-2 hide_till_print"},"تقرير فواتير التوريد",-1),Tt=t("tr",null,[t("th",null,"رقم"),t("th",null,"التاريخ"),t("th",null,"الصومعه"),t("th",null,"المورد"),t("th",null,"المستند"),t("th",null,"رقم السيارة"),t("th",null,"منتج / فرز"),t("th",null,"الكمية"),t("th",null,"قبل الخصم"),t("th",null,"قيمة الخصم"),t("th",null,"بعد الخصم")],-1),Ft={key:0},kt=t("td",{colspan:"7",style:{"font-size":"14px"}},"الاجمالي",-1),wt={colspan:"1",style:{"font-size":"14px"}},Vt={colspan:"1",style:{"font-size":"14px"}},$t={style:{"font-size":"14px"}},Mt={style:{"font-size":"14px"}},Yt=t("div",{class:"d-none"},null,-1),Pt=t("div",null,"لايوجد بيانات",-1),Wt={__name:"Invoices",props:["invoices","loading","suppliers","granaries"],emits:["regetItems","filterData"],setup(r,{emit:y}){const g=r,m=I(1),_=I(1e4),k=I([{title:"رقم",key:"index"},{title:"التاريخ",key:"invoiceDate"},{title:"الصومعة",key:"granary.name"},{title:"المورد",key:"supplier.name"},{title:"المستند",key:"documentNumber"},{title:"رقم السيارة",key:"carNumber"},{title:"منتج / فرز",key:"productDetails"},{title:"بعد الخصم",key:"totalInvoicePriceAfterDiscount"},{title:"قبل الخصم",key:"totalInvoicePrice"},{title:"قيمة الخصم",key:"totalDiscountWithAging"},{title:"بعد الخصم والتعتيق",key:"totalAfterDiscountWithAging"}]),w=[{title:"الرئيسية",disabled:!1,to:{name:"index"}},{title:"التقارير",to:{name:"reports"}},{title:"تقرير التوريدات",disabled:!0}],D=I({id:"printable",popTitle:" -",extraCss:"https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.1/animate.compat.css, https://cdn.bootcdn.net/ajax/libs/hover.css/2.3.1/css/hover-min.css",extraHead:'<meta http-equiv="Content-Language"content="zh-cn"/>'});S(()=>m.value,c=>{y("regetItems",{page:c,limit:_.value})}),S(()=>_.value,c=>{y("regetItems",{page:m.value,limit:c})});const o=U(()=>{const c={clearWeight:0,beforeDisc:0,disc:0,afterDisc:0};if(g.invoices&&g.invoices.content&&g.invoices.content.length)return g.invoices.content.forEach(d=>{c.clearWeight+=d.totalClearWeight,c.beforeDisc+=d.totalPrice,c.disc+=d.totalDiscountWithAging,c.afterDisc+=parseInt(d.totalAfterDiscountWithAging)}),c});return(c,d)=>{const u=p("v-icon"),a=p("v-btn"),f=p("v-breadcrumbs"),x=ht,b=p("v-col"),h=p("v-row"),M=p("v-container"),Y=L("print");return T(),$("div",yt,[t("div",Dt,[t("div",It,[P((T(),j(a,{width:"20",size:"sm",elevation:"0",color:"transparent"},{default:n(()=>[s(u,{color:"white",size:"25"},{default:n(()=>[v("mdi-printer")]),_:1})]),_:1})),[[Y,l(D)]])]),s(f,{items:w,dir:"rtl",class:"pa-0 mb"},{title:n(({item:e})=>[v(i(e.title.toUpperCase()),1)]),_:1})]),s(M,{class:"page_container",fluid:""},{default:n(()=>[r.invoices?(T(),j(h,{key:0,class:"px-4 mt-1"},{default:n(()=>[s(b,{cols:"12",class:"px-0"},{default:n(()=>[s(x,{class:"mb-7",loading:r.loading,onFilterData:d[0]||(d[0]=e=>y("filterData",e))},null,8,["loading"])]),_:1}),s(b,{cols:"12",class:"section_container dashboard_table pa-0",id:"printable"},{default:n(()=>[xt,s(l(H),{headers:l(k),items:r.invoices.content,loading:r.loading,"items-per-page":l(_),"onUpdate:itemsPerPage":d[1]||(d[1]=e=>z(_)?_.value=e:null),page:l(m),"onUpdate:page":d[2]||(d[2]=e=>z(m)?m.value=e:null),"items-length":r.invoices.totalElements?r.invoices.totalElements:0,"no-data-text":"لايوجد بيانات","show-current-page":"",id:"invoices_report_table"},{headers:n(()=>[Tt]),item:n(({item:e})=>[t("tr",null,[t("td",null,i(e.index+1),1),t("td",null,i(l(W)(e.selectable.date).format("DD/MM/YYYY")),1),t("td",null,i(e.selectable.granary.name),1),t("td",null,i(e.selectable.supplier.name),1),t("td",null,i(e.selectable.documentNumber),1),t("td",null,i(e.selectable.carNumber),1),t("td",null,i(e.selectable.product.name)+" / "+i(e.selectable.productType.name),1),t("td",null,i(e.selectable.totalClearWeight.toFixed(2)),1),t("td",null,i(e.selectable.totalPrice.toFixed(2)),1),t("td",null,i(e.selectable.totalDiscountWithAging.toFixed(2)),1),t("td",null,i(parseInt(e.selectable.totalAfterDiscountWithAging)),1)]),e.index+1==r.invoices.content.length?(T(),$("tr",Ft,[kt,t("td",wt,i(l(o).clearWeight.toFixed(2)),1),t("td",Vt,i(l(o).beforeDisc.toFixed(2)),1),t("td",$t,i(l(o).disc.toFixed(2)),1),t("td",Mt,i(l(o).afterDisc),1)])):G("",!0)]),bottom:n(()=>[Yt]),loading:n(()=>[s(l(J),{type:"table-row@4"})]),"no-data":n(()=>[Pt]),_:1},8,["headers","items","loading","items-per-page","page","items-length"])]),_:1})]),_:1})):G("",!0)]),_:1})])}}},At=Wt,Ct={class:"dashboard_tests_page mb-10"},Bt={__name:"index",setup(r){const y=O(),g=B(),m=R(),{invoices:_}=F(y),{granaries:k}=F(m),{suppliers:w}=F(g),D=I(!1),o=I({supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,ToDate:null}),c=async(d,u,a)=>{D.value=!0,o.value=a||{supplierId:null,granaryId:null,creationFromDate:null,creationToDate:null,FromDate:null,ToDate:null},await y.doGetInvoices(d-1,u,o.value),D.value=!1};return N(()=>{_.value=[],g.doGetSuppliers(0,1e4),m.doGetGranaries(0,1e4)}),(d,u)=>{const a=At;return T(),$("div",Ct,[s(a,{invoices:l(_),loading:l(D),granaries:l(k).content,suppliers:l(w).content,onRegetItems:u[0]||(u[0]=f=>c(f.page,f.limit)),onFilterData:u[1]||(u[1]=f=>c(1,1e3,f))},null,8,["invoices","loading","granaries","suppliers"])])}}};export{Bt as default};
