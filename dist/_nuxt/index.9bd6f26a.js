import{J as Y,r as y,c as E,z as L,o as H,f as p,k as v,l as V,q as n,s as l,m as e,C as t,D as R,v as D,t as k,F,B as G,E as N,I as C,K as te,L as le,G as M,H as ne}from"./entry.9ac21750.js";import{h as q}from"./moment.a9aaa855.js";import{c as O}from"./clients.efb1b936.js";import{c as z,r as B,u as J,n as oe,b as ae}from"./index.7c7e0372.js";import{V as se,a as ie}from"./VSkeletonLoader.f41b8ad8.js";import{g as re}from"./granary.552dc71b.js";import{s as de}from"./supplier.33ca5a1d.js";const ce={class:"supplierPaymentReportFilter"},ue={class:"field_container"},pe=e("label",{for:"supplierId"},"اختر العميل",-1),me={class:"input_parent position-relative"},_e={key:0,class:"err_msg"},ve={class:"field_container"},ge=e("label",{for:"granaryId"},"اختر الصومعة",-1),fe={class:"input_parent position-relative"},ye={key:0,class:"err_msg"},be={class:"field_container",dir:"rtl"},he=e("label",{for:"FromDate"},"من",-1),De={class:"input_parent position-relative"},$e=["disabled"],xe={class:"field_container",dir:"rtl"},we=e("label",{for:"ToDate"},"الي",-1),Ie={class:"input_parent position-relative"},ke=["disabled"],Fe={__name:"Filter",props:["loading","reFilter"],emits:["filterData","refiltered"],setup(s,{emit:I}){const m=s,g=O(),{clientLockup:f}=Y(g),o=y({clientID:null,granaryId:null,FromDate:null,ToDate:null}),h=y({clientID:{required:z.withMessage("هذا الحقل مطلوب",B)},granaryId:{required:z.withMessage("هذا الحقل مطلوب",B)}});let _=J(h,o);const T=E(()=>o.value.clientID?f.value.find(b=>b.client.id==o.value.clientID).granaryList:[]);L(()=>m.reFilter,b=>{b&&($(),I("refiltered"))});const $=async()=>{if(await _.value.$validate()){const i={clientID:o.value.clientID,granaryId:o.value.granaryId,FromDate:o.value.FromDate?q(o.value.FromDate).format("DD/MM/YYYY"):null,ToDate:o.value.ToDate?q(Date.now(o.value.ToDate)+864e5).format("DD/MM/YYYY"):null};I("filterData",i)}};return H(()=>{g.doGetClientsLockup()}),(b,i)=>{const r=p("v-autocomplete"),x=p("v-icon"),P=p("v-col"),w=p("v-btn"),u=p("v-row");return v(),V("div",ce,[n(u,{dir:"rtl",class:"pt-0"},{default:l(()=>[n(P,{cols:"12",sm:"6",md:"4",lg:"3",class:"pt-0"},{default:l(()=>[e("div",ue,[pe,e("div",me,[n(r,{"item-title":"client.name","item-value":"client.id",items:t(f),transition:"slide-y-transition",variant:"outlined","hide-details":"",modelValue:t(o).clientID,"onUpdate:modelValue":i[0]||(i[0]=d=>t(o).clientID=d),placeholder:"اختر العميل",disabled:s.loading,class:R(t(_).$errors.find(d=>d.$property=="clientID")?"err_field":"")},null,8,["items","modelValue","disabled","class"]),n(x,{class:"position-absolute"},{default:l(()=>[D("mdi-account-cowboy-hat")]),_:1})]),t(_).$errors.find(d=>d.$property=="clientID")?(v(),V("span",_e,k(t(_).$errors.find(d=>d.$property=="clientID").$message),1)):F("",!0)])]),_:1}),n(P,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",ve,[ge,e("div",fe,[n(r,{"item-title":"name","item-value":"id",items:t(T),transition:"slide-y-transition",variant:"outlined",disabled:s.loading,placeholder:"اختر الصومعة","hide-details":"",modelValue:t(o).granaryId,"onUpdate:modelValue":i[1]||(i[1]=d=>t(o).granaryId=d),class:R(t(_).$errors.find(d=>d.$property=="granaryId")?"err_field":"")},null,8,["items","disabled","modelValue","class"]),n(x,{class:"position-absolute"},{default:l(()=>[D("mdi-store-24-hour")]),_:1})]),t(_).$errors.find(d=>d.$property=="clientID")?(v(),V("span",ye,k(t(_).$errors.find(d=>d.$property=="clientID").$message),1)):F("",!0)])]),_:1}),n(P,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",be,[he,e("div",De,[G(e("input",{type:"date",name:"FromDate",id:"FromDate",disabled:s.loading,"onUpdate:modelValue":i[2]||(i[2]=d=>t(o).FromDate=d),style:{"padding-right":"0 !important"}},null,8,$e),[[N,t(o).FromDate]]),n(x,{class:"position-absolute"},{default:l(()=>[D("mdi-calendar")]),_:1})])])]),_:1}),n(P,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",xe,[we,e("div",Ie,[G(e("input",{type:"date",name:"ToDate","onUpdate:modelValue":i[3]||(i[3]=d=>t(o).ToDate=d),disabled:s.loading,id:"ToDate",style:{"padding-right":"0 !important"}},null,8,ke),[[N,t(o).ToDate]]),n(x,{class:"position-absolute"},{default:l(()=>[D("mdi-calendar")]),_:1})])])]),_:1}),n(P,{cols:"12",sm:"6",md:"4",lg:"3",style:{display:"flex","align-items":"flex-end"},class:"pt-0"},{default:l(()=>[n(w,{color:"blue",width:"100",height:"40",elevation:"0",onClick:$,class:"font-weight-bold",style:{"margin-bottom":"2px"},disabled:s.loading},{default:l(()=>[D("بحث")]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},Ve=Fe,Te={class:"pay_client_due"},Pe=e("thead",null,[e("tr",null,[e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," تاريخ "),e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," المبلغ المتبقي "),e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," حالة الدفع ")])],-1),Ce={style:{"font-size":"15px"}},Me={style:{"font-size":"15px"}},Ue={style:{"font-size":"15px"}},ze={class:"pt-5"},Ge=e("td",{style:{"font-weight":"bold","font-size":"18px"}},"الاجمالي",-1),Ye={style:{"font-weight":"bold","font-size":"18px"}},Le=e("td",null,null,-1),Ne={style:{"background-color":"white !important"}},je=e("td",null,null,-1),Ae={class:"field_container pt-5"},Se={class:"input_parent"},Ee={key:0,class:"err_msg pt-2 d-block mb-0 pb-0"},Re={class:"field_container"},qe={class:"input_parent px-5 text-end"},Be=e("label",{for:""},"اضافة ملاحظة",-1),He={class:"actions text-center mt-5"},Oe={__name:"PayNow",props:["openPopup","selected","selectedGranary"],emits:["closePopup","regetData"],setup(s,{emit:I}){const m=s,g=O(),f=y({paymentAmount:null,transactionType:"تحويل بنكي",notes:null}),o=y(!1),h=y(!1),_=E(()=>{let i=0;return m.selected&&m.selected.length&&m.selected.forEach(r=>i+=r.remaining),i}),T=E(()=>({paymentAmount:{required:z.withMessage("هذا الحقل مطلوب",B),numeric:z.withMessage("هذا الحقل يقبل ارقام فقط",oe),between:z.withMessage(`قم بادخال رقم بين 1 و ${_.value}`,ae(1,_.value))}})),$=J(T,f),b=async()=>{if(await $.value.$validate()){const r={amountToPay:f.value.paymentAmount,duesDTOList:m.selected,granary:{id:m.selectedGranary},transactionType:f.value.transactionType,notes:f.value.notes};h.value=!0;const x=await g.doPayClients(r);h.value=!1,x&&(I("regetData"),o.value=!1)}};return L(()=>o.value,i=>{i||setTimeout(()=>{I("closePopup")},200)}),H(()=>{o.value=m.openPopup}),(i,r)=>{const x=p("v-card-title"),P=p("v-chip"),w=p("v-radio"),u=p("v-radio-group"),d=p("v-table"),U=p("v-btn"),j=p("v-card"),A=p("v-dialog");return v(),V("div",Te,[n(A,{modelValue:t(o),"onUpdate:modelValue":r[4]||(r[4]=c=>M(o)?o.value=c:null),width:"800",persistent:""},{default:l(()=>[n(j,{class:"pb-5","max-height":"90vh"},{default:l(()=>[n(x,{class:"mb-0 text-center bg-grey-lighten-3 main_title font-safe-bold",style:{"font-size":"22px"}},{default:l(()=>[D(" اضافة سدادات جديدة ")]),_:1}),s.selected&&s.selected.length?(v(),C(d,{key:0,class:"text-center w-100"},{default:l(()=>[Pe,(v(!0),V(te,null,le(s.selected,(c,S)=>(v(),V("tbody",{key:c.id},[e("tr",null,[e("td",Ce,k(c.date),1),e("td",Me,k(c.remaining.toFixed(2)),1),e("td",Ue,[c.isFullPayed?(v(),C(P,{key:0,color:"green"},{default:l(()=>[D("مكتمل")]),_:1})):F("",!0),c.isFullPayed?F("",!0):(v(),C(P,{key:1,color:"red"},{default:l(()=>[D("غير مكتمل")]),_:1}))])])]))),128)),e("tfoot",null,[e("tr",ze,[Ge,e("td",Ye,k(t(_).toFixed(2)),1),Le]),e("tr",Ne,[je,e("td",null,[e("div",Ae,[e("div",Se,[G(e("input",{class:R(["px-0 text-center",t($).$errors.find(c=>c.$property=="paymentAmount")?"err_field":""]),style:{width:"100%"},placeholder:"قم بادخال مبلغ السداد",type:"text","onUpdate:modelValue":r[0]||(r[0]=c=>t(f).paymentAmount=c)},null,2),[[N,t(f).paymentAmount]])]),t($).$errors.find(c=>c.$property=="paymentAmount")?(v(),V("span",Ee,k(t($).$errors.find(c=>c.$property=="paymentAmount").$message),1)):F("",!0)])]),e("td",null,[n(u,{modelValue:t(f).transactionType,"onUpdate:modelValue":r[1]||(r[1]=c=>t(f).transactionType=c),inline:"",class:"mt-9"},{default:l(()=>[n(w,{label:"تحويل بنكي",class:"mr-2",value:"تحويل بنكي"}),n(w,{label:"شيك",value:"شيك"})]),_:1},8,["modelValue"])])])])]),_:1})):F("",!0),e("div",Re,[e("div",qe,[Be,G(e("textarea",{class:"px-5 text-end",style:{width:"100%",resize:"none"},placeholder:"اضافة ملاحظة",type:"text","onUpdate:modelValue":r[2]||(r[2]=c=>t(f).notes=c),rows:5},null,512),[[N,t(f).notes]])])]),e("div",He,[n(U,{color:"red",class:"mr-3",onClick:r[3]||(r[3]=c=>o.value=!1),width:"100",disabled:t(h)},{default:l(()=>[D("الغاء")]),_:1},8,["disabled"]),n(U,{color:"green",onClick:b,loading:t(h),width:"100"},{default:l(()=>[D("دفع")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])])}}},Je=Oe;const Ke={class:"dashboard_banners_listing"},Qe={class:"page_toolbar d-flex align-center justify-space-between"},We={class:"toolbar_btns"},Xe=e("h1",{dir:"rtl",class:"my-2 hide_till_print"},"مستحقات الشركة",-1),Ze=e("div",null,"لايوجد بيانات",-1),et=e("span",{class:"d-none"},null,-1),tt={key:0,class:"text-center pt-2 d-flex justify-space-between hide_on_print",style:{width:"60%"}},lt={class:"ps-5 d-flex align-center"},nt=e("label",{for:"",class:"mb-2 d-block text-end ms-3 mt-1",style:{"font-size":"12px"}},"النتائج لكل صفحة",-1),ot={key:1,class:"text-end my-5 me-5 hide_on_print"},at={__name:"Invoices",props:["invoices","loading","suppliers","granaries"],emits:["regetItems","filterData"],setup(s,{emit:I}){const m=y(1),g=y(10),f=y([{title:"رقم",key:"index"},{title:"التاريخ",key:"date"},{title:"اجمالي الكمية",key:"totalQuantitySupplied"},{title:"اجمالي القيمة",key:"totalCompanyDues"},{title:"القيمة المدفوعة",key:"paied"},{title:"القيمة المتبقية",key:"remaining"},{title:"حالة الدفع",key:"isFullPayed"}]),o=[{title:"الرئيسية",disabled:!1,to:{name:"index"}},{title:"مستحقات الشركة",disabled:!0}],h=y([]),_=y(!1),T=y(!1),$=y(""),b=y(""),i=y(""),r=y(""),x=y({id:"printable",popTitle:" -",extraCss:"https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.1/animate.compat.css, https://cdn.bootcdn.net/ajax/libs/hover.css/2.3.1/css/hover-min.css",extraHead:'<meta http-equiv="Content-Language"content="zh-cn"/>'}),P=w=>{$.value=w.granaryId,b.value=w.clientID,i.value=w.FromDate,r.value=w.ToDate,h.value=[],I("filterData",{...w,limit:g.value,page:m.value})};return L(()=>m.value,w=>{I("filterData",{FromDate:i.value,ToDate:r.value,clientID:b.value,granaryId:$.value,page:w,limit:g.value})}),L(()=>g.value,w=>{I("filterData",{FromDate:i.value,ToDate:r.value,clientID:b.value,granaryId:$.value,page:m.value,limit:w})}),(w,u)=>{const d=p("v-icon"),U=p("v-btn"),j=p("v-breadcrumbs"),A=Ve,c=p("v-col"),S=p("v-chip"),K=p("v-select"),Q=p("v-pagination"),W=p("v-row"),X=p("v-container"),Z=Je,ee=ne("print");return v(),V("div",Ke,[e("div",Qe,[e("div",We,[G((v(),C(U,{width:"20",size:"sm",elevation:"0",color:"transparent"},{default:l(()=>[n(d,{color:"white",size:"25"},{default:l(()=>[D("mdi-printer")]),_:1})]),_:1})),[[ee,t(x)]])]),n(j,{items:o,dir:"rtl",class:"pa-0 mb"},{title:l(({item:a})=>[D(k(a.title.toUpperCase()),1)]),_:1})]),n(X,{class:"page_container",fluid:""},{default:l(()=>[s.invoices?(v(),C(W,{key:0,class:"px-4 mt-1"},{default:l(()=>[n(c,{cols:"12",class:"px-0"},{default:l(()=>[n(A,{class:"mb-7",loading:s.loading,onFilterData:P,reFilter:t(T),onRefiltered:u[0]||(u[0]=a=>(T.value=!1,h.value=[]))},null,8,["loading","reFilter"])]),_:1}),n(c,{cols:"12",class:"section_container dashboard_table pa-0",id:"printable"},{default:l(()=>[Xe,n(t(se),{headers:t(f),items:s.invoices.content,loading:s.loading,"items-per-page":t(g),"onUpdate:itemsPerPage":u[1]||(u[1]=a=>M(g)?g.value=a:null),modelValue:t(h),"onUpdate:modelValue":u[2]||(u[2]=a=>M(h)?h.value=a:null),page:t(m),"onUpdate:page":u[3]||(u[3]=a=>M(m)?m.value=a:null),"items-length":s.invoices.totalElements?s.invoices.totalElements:0,"no-data-text":"لايوجد بيانات","show-current-page":"",id:"clients_payments","return-object":"","show-select":!!(s.invoices.content&&s.invoices.content.length)},{loading:l(()=>[n(t(ie),{type:"table-row@4"})]),"item.index":l(({item:a})=>[D(k(a.index+1),1)]),"item.invoiceDate":l(({item:a})=>[e("p",null,k(t(q)(a.selectable.date).format("DD/MM/YYYY")),1)]),"item.totalCompanyDues":l(({item:a})=>[e("p",null,k(Number(a.selectable.totalCompanyDues).toFixed(2)),1)]),"item.paied":l(({item:a})=>[e("p",null,k(Number(a.selectable.paied).toFixed(2)),1)]),"item.remaining":l(({item:a})=>[e("p",null,k(Number(a.selectable.remaining).toFixed(2)),1)]),"item.isFullPayed":l(({item:a})=>[a.selectable.isFullPayed?(v(),C(S,{key:0,color:"green",label:""},{default:l(()=>[D("مكتمل")]),_:1})):F("",!0),a.selectable.isFullPayed?F("",!0):(v(),C(S,{key:1,color:"red",label:""},{default:l(()=>[D("غير مكتمل")]),_:1}))]),"no-data":l(()=>[Ze]),bottom:l(()=>[et]),_:1},8,["headers","items","loading","items-per-page","modelValue","page","items-length","show-select"]),!s.loading&&s.invoices.content&&s.invoices.content.length?(v(),V("div",tt,[e("div",lt,[n(K,{modelValue:t(g),"onUpdate:modelValue":u[4]||(u[4]=a=>M(g)?g.value=a:null),items:[10,50,100,500],variant:"outlined","hide-details":""},null,8,["modelValue"]),nt]),n(Q,{modelValue:t(m),"onUpdate:modelValue":u[5]||(u[5]=a=>M(m)?m.value=a:null),length:s.invoices.totalElements?Math.ceil(s.invoices.totalElements/t(g)):1},null,8,["modelValue","length"])])):F("",!0),t(h).length?(v(),V("div",ot,[n(U,{color:"green",onClick:u[6]||(u[6]=a=>_.value=!0)},{default:l(()=>[D("دفع")]),_:1})])):F("",!0)]),_:1})]),_:1})):F("",!0)]),_:1}),t(_)?(v(),C(Z,{key:0,openPopup:t(_),onClosePopup:u[7]||(u[7]=a=>_.value=!1),selected:t(h),onRegetData:u[8]||(u[8]=a=>T.value=!0),selectedGranary:t($)},null,8,["openPopup","selected","selectedGranary"])):F("",!0)])}}},st=at,it={class:"dashboard_clients_payments mb-10"},vt={__name:"index",setup(s){const I=O(),m=de(),g=re(),{clientInvoices:f}=Y(I),{granaries:o}=Y(g),{suppliers:h}=Y(m),_=y(!1),T=y({clientID:null,granaryId:null,FromDate:null,ToDate:null}),$=async b=>{_.value=!0,T.value=b||{clientID:null,granaryId:null,FromDate:null,ToDate:null},await I.doGetClientInvoices(b.page-1,b.limit,T.value),_.value=!1};return H(()=>{f.value=[],m.doGetSuppliers(0,1e4),g.doGetGranaries(0,1e4)}),(b,i)=>{const r=st;return v(),V("div",it,[n(r,{invoices:t(f),loading:t(_),granaries:t(o).content,suppliers:t(h).content,onRegetItems:i[0]||(i[0]=x=>$(x.page,x.limit)),onFilterData:i[1]||(i[1]=x=>$(x))},null,8,["invoices","loading","granaries","suppliers"])])}}};export{vt as default};
