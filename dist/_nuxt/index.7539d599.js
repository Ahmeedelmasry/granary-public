import{I as Y,r as y,c as R,z as N,o as j,f as p,k as b,l as T,q as o,s as l,m as e,C as t,D as q,v as h,t as F,F as k,B as A,E as S,H as P,J as W,K as X,G as z}from"./entry.0a484266.js";import{h as B}from"./moment.a9aaa855.js";import{c as H}from"./clients.42385680.js";import{c as M,r as E,u as K,n as Z,b as ee}from"./index.28147b1b.js";import{V as te,a as le}from"./VSkeletonLoader.ec353db9.js";import{g as oe}from"./granary.877d6f42.js";import{s as ne}from"./supplier.ec4415e2.js";const ae={class:"supplierPaymentReportFilter"},se={class:"field_container"},ie=e("label",{for:"supplierId"},"اختر العميل",-1),re={class:"input_parent position-relative"},de={key:0,class:"err_msg"},ce={class:"field_container"},ue=e("label",{for:"granaryId"},"اختر الصومعة",-1),pe={class:"input_parent position-relative"},me={key:0,class:"err_msg"},_e={class:"field_container",dir:"rtl"},ve=e("label",{for:"FromDate"},"من",-1),fe={class:"input_parent position-relative"},ge=["disabled"],ye={class:"field_container",dir:"rtl"},be=e("label",{for:"ToDate"},"الي",-1),De={class:"input_parent position-relative"},he=["disabled"],$e={__name:"Filter",props:["loading","reFilter"],emits:["filterData","refiltered"],setup(c,{emit:I}){const v=c,w=H(),{clientLockup:f}=Y(w),n=y({clientID:null,granaryId:null,FromDate:null,ToDate:null}),D=y({clientID:{required:M.withMessage("هذا الحقل مطلوب",E)},granaryId:{required:M.withMessage("هذا الحقل مطلوب",E)}});let u=K(D,n);const V=R(()=>n.value.clientID?f.value.find(g=>g.client.id==n.value.clientID).granaryList:[]);N(()=>v.reFilter,g=>{g&&($(),I("refiltered"))});const $=async()=>{if(await u.value.$validate()){const a={clientID:n.value.clientID,granaryId:n.value.granaryId,FromDate:n.value.FromDate?B(n.value.FromDate).format("DD/MM/YYYY"):null,ToDate:n.value.ToDate?B(Date.now(n.value.ToDate)+864e5).format("DD/MM/YYYY"):null};I("filterData",a)}};return j(()=>{w.doGetClientsLockup()}),(g,a)=>{const r=p("v-autocomplete"),x=p("v-icon"),m=p("v-col"),_=p("v-btn"),C=p("v-row");return b(),T("div",ae,[o(C,{dir:"rtl",class:"pt-0"},{default:l(()=>[o(m,{cols:"12",sm:"6",md:"4",lg:"3",class:"pt-0"},{default:l(()=>[e("div",se,[ie,e("div",re,[o(r,{"item-title":"client.name","item-value":"client.id",items:t(f),transition:"slide-y-transition",variant:"outlined","hide-details":"",modelValue:t(n).clientID,"onUpdate:modelValue":a[0]||(a[0]=s=>t(n).clientID=s),placeholder:"اختر العميل",disabled:c.loading,class:q(t(u).$errors.find(s=>s.$property=="clientID")?"err_field":"")},null,8,["items","modelValue","disabled","class"]),o(x,{class:"position-absolute"},{default:l(()=>[h("mdi-account-cowboy-hat")]),_:1})]),t(u).$errors.find(s=>s.$property=="clientID")?(b(),T("span",de,F(t(u).$errors.find(s=>s.$property=="clientID").$message),1)):k("",!0)])]),_:1}),o(m,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",ce,[ue,e("div",pe,[o(r,{"item-title":"name","item-value":"id",items:t(V),transition:"slide-y-transition",variant:"outlined",disabled:c.loading,placeholder:"اختر الصومعة","hide-details":"",modelValue:t(n).granaryId,"onUpdate:modelValue":a[1]||(a[1]=s=>t(n).granaryId=s),class:q(t(u).$errors.find(s=>s.$property=="granaryId")?"err_field":"")},null,8,["items","disabled","modelValue","class"]),o(x,{class:"position-absolute"},{default:l(()=>[h("mdi-store-24-hour")]),_:1})]),t(u).$errors.find(s=>s.$property=="clientID")?(b(),T("span",me,F(t(u).$errors.find(s=>s.$property=="clientID").$message),1)):k("",!0)])]),_:1}),o(m,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",_e,[ve,e("div",fe,[A(e("input",{type:"date",name:"FromDate",id:"FromDate",disabled:c.loading,"onUpdate:modelValue":a[2]||(a[2]=s=>t(n).FromDate=s),style:{"padding-right":"0 !important"}},null,8,ge),[[S,t(n).FromDate]]),o(x,{class:"position-absolute"},{default:l(()=>[h("mdi-calendar")]),_:1})])])]),_:1}),o(m,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[e("div",ye,[be,e("div",De,[A(e("input",{type:"date",name:"ToDate","onUpdate:modelValue":a[3]||(a[3]=s=>t(n).ToDate=s),disabled:c.loading,id:"ToDate",style:{"padding-right":"0 !important"}},null,8,he),[[S,t(n).ToDate]]),o(x,{class:"position-absolute"},{default:l(()=>[h("mdi-calendar")]),_:1})])])]),_:1}),o(m,{cols:"12",sm:"6",md:"4",lg:"3",style:{display:"flex","align-items":"flex-end"},class:"pt-0"},{default:l(()=>[o(_,{color:"blue",width:"100",height:"40",elevation:"0",onClick:$,class:"font-weight-bold",style:{"margin-bottom":"2px"},disabled:c.loading},{default:l(()=>[h("بحث")]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},xe=$e,we={class:"pay_client_due"},Ie=e("thead",null,[e("tr",null,[e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," تاريخ "),e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," المبلغ المتبقي "),e("th",{style:{"background-color":"#f3f3f3 !important"},class:"text-center font-weight-bold"}," حالة الدفع ")])],-1),Fe={style:{"font-size":"15px"}},ke={style:{"font-size":"15px"}},Ve={style:{"font-size":"15px"}},Te={class:"pt-5"},Pe=e("td",{style:{"font-weight":"bold","font-size":"18px"}},"الاجمالي",-1),Ce={style:{"font-weight":"bold","font-size":"18px"}},Me=e("td",null,null,-1),Ge={style:{"background-color":"white !important"}},Ue=e("td",null,null,-1),Ye={class:"field_container pt-5"},ze={class:"input_parent"},Ne={key:0,class:"err_msg pt-2 d-block mb-0 pb-0"},Ae={class:"field_container"},Se={class:"input_parent px-5 text-end"},Le=e("label",{for:""},"اضافة ملاحظة",-1),Re={class:"actions text-center mt-5"},qe={__name:"PayNow",props:["openPopup","selected","selectedGranary"],emits:["closePopup","regetData"],setup(c,{emit:I}){const v=c,w=H(),f=y({paymentAmount:null,transactionType:"تحويل بنكي",notes:null}),n=y(!1),D=y(!1),u=R(()=>{let a=0;return v.selected&&v.selected.length&&v.selected.forEach(r=>a+=r.remaining),a}),V=R(()=>({paymentAmount:{required:M.withMessage("هذا الحقل مطلوب",E),numeric:M.withMessage("هذا الحقل يقبل ارقام فقط",Z),between:M.withMessage(`قم بادخال رقم بين 1 و ${u.value}`,ee(1,u.value))}})),$=K(V,f),g=async()=>{if(await $.value.$validate()){const r={amountToPay:f.value.paymentAmount,duesDTOList:v.selected,granary:{id:v.selectedGranary},transactionType:f.value.transactionType,notes:f.value.notes};D.value=!0;const x=await w.doPayClients(r);D.value=!1,x&&(I("regetData"),n.value=!1)}};return N(()=>n.value,a=>{a||setTimeout(()=>{I("closePopup")},200)}),j(()=>{n.value=v.openPopup}),(a,r)=>{const x=p("v-card-title"),m=p("v-chip"),_=p("v-radio"),C=p("v-radio-group"),s=p("v-table"),G=p("v-btn"),L=p("v-card"),U=p("v-dialog");return b(),T("div",we,[o(U,{modelValue:t(n),"onUpdate:modelValue":r[4]||(r[4]=d=>z(n)?n.value=d:null),width:"800",persistent:""},{default:l(()=>[o(L,{class:"pb-5","max-height":"90vh"},{default:l(()=>[o(x,{class:"mb-0 text-center bg-grey-lighten-3 main_title font-safe-bold",style:{"font-size":"22px"}},{default:l(()=>[h(" اضافة سدادات جديدة ")]),_:1}),c.selected&&c.selected.length?(b(),P(s,{key:0,class:"text-center w-100"},{default:l(()=>[Ie,(b(!0),T(W,null,X(c.selected,(d,J)=>(b(),T("tbody",{key:d.id},[e("tr",null,[e("td",Fe,F(d.date),1),e("td",ke,F(d.remaining.toFixed(2)),1),e("td",Ve,[d.isFullPayed?(b(),P(m,{key:0,color:"green"},{default:l(()=>[h("مكتمل")]),_:1})):k("",!0),d.isFullPayed?k("",!0):(b(),P(m,{key:1,color:"red"},{default:l(()=>[h("غير مكتمل")]),_:1}))])])]))),128)),e("tfoot",null,[e("tr",Te,[Pe,e("td",Ce,F(t(u).toFixed(2)),1),Me]),e("tr",Ge,[Ue,e("td",null,[e("div",Ye,[e("div",ze,[A(e("input",{class:q(["px-0 text-center",t($).$errors.find(d=>d.$property=="paymentAmount")?"err_field":""]),style:{width:"100%"},placeholder:"قم بادخال مبلغ السداد",type:"text","onUpdate:modelValue":r[0]||(r[0]=d=>t(f).paymentAmount=d)},null,2),[[S,t(f).paymentAmount]])]),t($).$errors.find(d=>d.$property=="paymentAmount")?(b(),T("span",Ne,F(t($).$errors.find(d=>d.$property=="paymentAmount").$message),1)):k("",!0)])]),e("td",null,[o(C,{modelValue:t(f).transactionType,"onUpdate:modelValue":r[1]||(r[1]=d=>t(f).transactionType=d),inline:"",class:"mt-9"},{default:l(()=>[o(_,{label:"تحويل بنكي",class:"mr-2",value:"تحويل بنكي"}),o(_,{label:"شيك",value:"شيك"})]),_:1},8,["modelValue"])])])])]),_:1})):k("",!0),e("div",Ae,[e("div",Se,[Le,A(e("textarea",{class:"px-5 text-end",style:{width:"100%",resize:"none"},placeholder:"اضافة ملاحظة",type:"text","onUpdate:modelValue":r[2]||(r[2]=d=>t(f).notes=d),rows:5},null,512),[[S,t(f).notes]])])]),e("div",Re,[o(G,{color:"red",class:"mr-3",onClick:r[3]||(r[3]=d=>n.value=!1),width:"100",disabled:t(D)},{default:l(()=>[h("الغاء")]),_:1},8,["disabled"]),o(G,{color:"green",onClick:g,loading:t(D),width:"100"},{default:l(()=>[h("دفع")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])])}}},Be=qe;const Ee={class:"dashboard_banners_listing"},je={class:"page_toolbar d-flex align-center justify-space-between"},He={class:"toolbar_btns"},Je=e("div",null,"لايوجد بيانات",-1),Ke={key:0,class:"text-end my-5 me-5"},Oe={__name:"Invoices",props:["invoices","loading","suppliers","granaries"],emits:["regetItems","filterData"],setup(c,{emit:I}){const v=y(1),w=y(10),f=y([{title:"رقم",key:"index"},{title:"التاريخ",key:"date"},{title:"اجمالي الكمية",key:"totalQuantitySupplied"},{title:"اجمالي القيمة",key:"totalCompanyDues"},{title:"القيمة المدفوعة",key:"paied"},{title:"القيمة المتبقية",key:"remaining"},{title:"حالة الدفع",key:"isFullPayed"}]),n=[{title:"الرئيسية",disabled:!1,to:{name:"index"}},{title:"مستحقات الشركة",disabled:!0}],D=y([]),u=y(!1),V=y(!1),$=y(""),g=y(""),a=y(""),r=y(""),x=m=>{$.value=m.granaryId,g.value=m.clientID,a.value=m.FromDate,r.value=m.ToDate,D.value=[],I("filterData",{...m,limit:w.value,page:v.value})};return N(()=>v.value,m=>{I("filterData",{FromDate:a.value,ToDate:r.value,clientID:g.value,granaryId:$.value,page:m,limit:w.value})}),N(()=>w.value,m=>{I("filterData",{FromDate:a.value,ToDate:r.value,clientID:g.value,granaryId:$.value,page:v.value,limit:m})}),(m,_)=>{const C=p("v-icon"),s=p("v-btn"),G=p("v-breadcrumbs"),L=xe,U=p("v-col"),d=p("v-chip"),J=p("v-row"),O=p("v-container"),Q=Be;return b(),T("div",Ee,[e("div",je,[e("div",He,[o(s,{width:"20",size:"sm",elevation:"0",color:"transparent"},{default:l(()=>[o(C,{color:"white",size:"25"},{default:l(()=>[h("mdi-printer")]),_:1})]),_:1})]),o(G,{items:n,dir:"rtl",class:"pa-0 mb"},{title:l(({item:i})=>[h(F(i.title.toUpperCase()),1)]),_:1})]),o(O,{class:"page_container",fluid:""},{default:l(()=>[c.invoices?(b(),P(J,{key:0,class:"px-4 mt-1"},{default:l(()=>[o(U,{cols:"12",class:"px-0"},{default:l(()=>[o(L,{class:"mb-7",loading:c.loading,onFilterData:x,reFilter:t(V),onRefiltered:_[0]||(_[0]=i=>(V.value=!1,D.value=[]))},null,8,["loading","reFilter"])]),_:1}),o(U,{cols:"12",class:"section_container dashboard_table pa-0"},{default:l(()=>[o(t(te),{headers:t(f),items:c.invoices.content,loading:c.loading,"items-per-page":t(w),"onUpdate:itemsPerPage":_[1]||(_[1]=i=>z(w)?w.value=i:null),modelValue:t(D),"onUpdate:modelValue":_[2]||(_[2]=i=>z(D)?D.value=i:null),page:t(v),"onUpdate:page":_[3]||(_[3]=i=>z(v)?v.value=i:null),"items-length":c.invoices.totalElements?c.invoices.totalElements:0,"no-data-text":"لايوجد بيانات","show-current-page":"",id:"clients_payments","return-object":"","show-select":!!(c.invoices.content&&c.invoices.content.length)},{loading:l(()=>[o(t(le),{type:"table-row@4"})]),"item.index":l(({item:i})=>[h(F(i.index+1),1)]),"item.invoiceDate":l(({item:i})=>[e("p",null,F(t(B)(i.selectable.date).format("DD/MM/YYYY")),1)]),"item.totalCompanyDues":l(({item:i})=>[e("p",null,F(Number(i.selectable.totalCompanyDues).toFixed(2)),1)]),"item.paied":l(({item:i})=>[e("p",null,F(Number(i.selectable.paied).toFixed(2)),1)]),"item.remaining":l(({item:i})=>[e("p",null,F(Number(i.selectable.remaining).toFixed(2)),1)]),"item.isFullPayed":l(({item:i})=>[i.selectable.isFullPayed?(b(),P(d,{key:0,color:"green",label:""},{default:l(()=>[h("مكتمل")]),_:1})):k("",!0),i.selectable.isFullPayed?k("",!0):(b(),P(d,{key:1,color:"red",label:""},{default:l(()=>[h("غير مكتمل")]),_:1}))]),"no-data":l(()=>[Je]),_:1},8,["headers","items","loading","items-per-page","modelValue","page","items-length","show-select"]),t(D).length?(b(),T("div",Ke,[o(s,{color:"green",onClick:_[4]||(_[4]=i=>u.value=!0)},{default:l(()=>[h("دفع")]),_:1})])):k("",!0)]),_:1})]),_:1})):k("",!0)]),_:1}),t(u)?(b(),P(Q,{key:0,openPopup:t(u),onClosePopup:_[5]||(_[5]=i=>u.value=!1),selected:t(D),onRegetData:_[6]||(_[6]=i=>V.value=!0),selectedGranary:t($)},null,8,["openPopup","selected","selectedGranary"])):k("",!0)])}}},Qe=Oe,We={class:"dashboard_clients_payments mb-10"},at={__name:"index",setup(c){const I=H(),v=ne(),w=oe(),{clientInvoices:f}=Y(I),{granaries:n}=Y(w),{suppliers:D}=Y(v),u=y(!1),V=y({clientID:null,granaryId:null,FromDate:null,ToDate:null}),$=async g=>{u.value=!0,V.value=g||{clientID:null,granaryId:null,FromDate:null,ToDate:null},await I.doGetClientInvoices(g.page-1,g.limit,V.value),u.value=!1};return j(()=>{f.value=[],v.doGetSuppliers(0,1e4),w.doGetGranaries(0,1e4)}),(g,a)=>{const r=Qe;return b(),T("div",We,[o(r,{invoices:t(f),loading:t(u),granaries:t(n).content,suppliers:t(D).content,onRegetItems:a[0]||(a[0]=x=>$(x.page,x.limit)),onFilterData:a[1]||(a[1]=x=>$(x))},null,8,["invoices","loading","granaries","suppliers"])])}}};export{at as default};
