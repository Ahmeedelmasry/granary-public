import{J as P,r as p,c as O,z as Y,R as Q,o as E,f as m,k as b,l as C,q as i,s as l,m as a,C as e,D as U,v as _,t as v,F as k,B as R,E as L,S as K,H as W,I as w,G as q}from"./entry.9ac21750.js";import{h as j}from"./moment.a9aaa855.js";import{c as N}from"./clients.efb1b936.js";import{c as z,r as B,u as X}from"./index.7c7e0372.js";import{V as Z,a as ee}from"./VSkeletonLoader.f41b8ad8.js";import{g as te}from"./granary.552dc71b.js";import{s as ae}from"./supplier.33ca5a1d.js";const le={class:"clientPaymentReportFilter"},ne={class:"field_container"},se=a("label",{for:"supplierId"},"اختر العميل",-1),oe={class:"input_parent position-relative"},ie={key:0,class:"err_msg"},re={class:"field_container"},de=a("label",{for:"granaryId"},"اختر الصومعة",-1),ce={class:"input_parent position-relative"},ue={key:0,class:"err_msg"},me={class:"field_container",dir:"rtl"},pe=a("label",{for:"FromDate"},"من",-1),_e={class:"input_parent position-relative"},ve=["disabled"],ge={class:"field_container",dir:"rtl"},ye=a("label",{for:"ToDate"},"الي",-1),be={class:"input_parent position-relative"},fe=["disabled"],De={__name:"Filter",props:["loading","reFilter"],emits:["filterData","refiltered"],setup(s,{emit:f}){const g=s,y=N(),{clientLockup:D}=P(y),n=p({clientID:null,granaryId:null,FromDate:null,ToDate:null,transactionType:null}),$=p({clientID:{required:z.withMessage("هذا الحقل مطلوب",B)},granaryId:{required:z.withMessage("هذا الحقل مطلوب",B)}});let c=X($,n);const x=O(()=>n.value.clientID?D.value.find(u=>u.client.id==n.value.clientID.client.id).granaryList:[]);Y(()=>g.reFilter,u=>{u&&(h(),f("refiltered"))});const F=Q("supplierSelect"),h=async()=>{if(await c.value.$validate()){const t={clientID:n.value.clientID.client,transactionType:n.value.transactionType,granaryId:n.value.granaryId,FromDate:n.value.FromDate?j(n.value.FromDate).format("DD/MM/YYYY"):null,ToDate:n.value.ToDate?j(n.value.ToDate).format("DD/MM/YYYY"):null};F(t),f("filterData",t)}};return E(()=>{y.doGetClientsLockup()}),(u,t)=>{const d=m("v-autocomplete"),T=m("v-icon"),I=m("v-col"),V=m("v-radio"),G=m("v-radio-group"),M=m("v-btn"),S=m("v-row");return b(),C("div",le,[i(S,{dir:"rtl",class:"pt-0"},{default:l(()=>[i(I,{cols:"12",sm:"6",md:"4",lg:"3",class:"pt-0"},{default:l(()=>[a("div",ne,[se,a("div",oe,[i(d,{"item-title":"client.name","item-value":"client.id",items:e(D),transition:"slide-y-transition",variant:"outlined","hide-details":"","onUpdate:modelValue":[t[0]||(t[0]=o=>e(n).granaryId=null),t[1]||(t[1]=o=>e(n).clientID=o)],modelValue:e(n).clientID,placeholder:"اختر العميل","return-object":"",disabled:s.loading,class:U(e(c).$errors.find(o=>o.$property=="clientID")?"err_field":"")},null,8,["items","modelValue","disabled","class"]),i(T,{class:"position-absolute"},{default:l(()=>[_("mdi-account-cowboy-hat")]),_:1})]),e(c).$errors.find(o=>o.$property=="clientID")?(b(),C("span",ie,v(e(c).$errors.find(o=>o.$property=="clientID").$message),1)):k("",!0)])]),_:1}),i(I,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[a("div",re,[de,a("div",ce,[i(d,{"item-title":"name","item-value":"id",items:e(x),transition:"slide-y-transition","return-object":"",variant:"outlined",disabled:s.loading,placeholder:"اختر الصومعة","hide-details":"",modelValue:e(n).granaryId,"onUpdate:modelValue":t[2]||(t[2]=o=>e(n).granaryId=o),class:U(e(c).$errors.find(o=>o.$property=="granaryId")?"err_field":"")},null,8,["items","disabled","modelValue","class"]),i(T,{class:"position-absolute"},{default:l(()=>[_("mdi-store-24-hour")]),_:1})]),e(c).$errors.find(o=>o.$property=="clientID")?(b(),C("span",ue,v(e(c).$errors.find(o=>o.$property=="clientID").$message),1)):k("",!0)])]),_:1}),i(I,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[a("div",me,[pe,a("div",_e,[R(a("input",{type:"date",name:"FromDate",id:"FromDate",disabled:s.loading,"onUpdate:modelValue":t[3]||(t[3]=o=>e(n).FromDate=o),style:{"padding-right":"0 !important"}},null,8,ve),[[L,e(n).FromDate]]),i(T,{class:"position-absolute"},{default:l(()=>[_("mdi-calendar")]),_:1})])])]),_:1}),i(I,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[a("div",ge,[ye,a("div",be,[R(a("input",{type:"date",name:"ToDate","onUpdate:modelValue":t[4]||(t[4]=o=>e(n).ToDate=o),disabled:s.loading,id:"ToDate",style:{"padding-right":"0 !important"}},null,8,fe),[[L,e(n).ToDate]]),i(T,{class:"position-absolute"},{default:l(()=>[_("mdi-calendar")]),_:1})])])]),_:1}),i(I,{cols:"12",sm:"6",md:"4",lg:"3",class:"py-0"},{default:l(()=>[a("div",null,[i(G,{modelValue:e(n).transactionType,"onUpdate:modelValue":t[6]||(t[6]=o=>e(n).transactionType=o),inline:"",class:"mt-3"},{default:l(()=>[i(V,{label:"شيك",value:"شيك"}),i(V,{label:"تحويل بنكي",class:"mr-2",value:"تحويل بنكي",modelValue:e(n).transactionType,"onUpdate:modelValue":t[5]||(t[5]=o=>e(n).transactionType=o)},null,8,["modelValue"]),i(V,{label:"الكل",value:null})]),_:1},8,["modelValue"])])]),_:1}),i(I,{cols:"12",sm:"6",md:"4",lg:"3",style:{display:"flex","align-items":"flex-end"},class:"pt-0"},{default:l(()=>[i(M,{color:"blue",width:"100",height:"40",elevation:"0",onClick:h,class:"font-weight-bold",style:{"margin-bottom":"2px"},disabled:s.loading},{default:l(()=>[_("بحث")]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},he=De;const Ie={class:"dues_supplier_payments"},$e={class:"w-100 text-right",dir:"rtl",style:{border:"1px solid rgb(179, 179, 179)","border-radius":"12px",padding:"13px",background:"#f0f0f0ba"},id:"not_styled_print"},xe=a("th",{class:"pb-2"},"اسم العميل:",-1),Fe={class:"pb-2"},Te=a("th",{class:"pb-2"},"اسم الصومعة:",-1),ke={class:"pb-2"},Ce=a("th",{class:"pb-2"},"تاريخ من",-1),Ve={class:"pb-2"},we=a("th",{class:"pb-2"},"تاريخ الي",-1),Me={__name:"ClientData",props:["selectedClient","selectedGranary","fromDate","toDate"],setup(s){return(f,g)=>(b(),C("div",Ie,[a("table",$e,[a("tbody",null,[a("tr",null,[xe,a("td",Fe,v(s.selectedClient?s.selectedClient.name:"الكل"),1),Te,a("td",ke,v(s.selectedGranary?s.selectedGranary.name:"الكل"),1)]),a("tr",null,[Ce,a("td",Ve,v(s.fromDate?s.fromDate:"الكل"),1),we,a("td",null,v(s.toDate?s.toDate:"الكل"),1)])])])]))}},Pe=Me;const Ge={class:"dashboard_banners_listing"},Se={class:"page_toolbar d-flex align-center justify-space-between"},Ye={class:"toolbar_btns"},Re=a("h1",{dir:"rtl",class:"my-2 hide_till_print"},"تقرير سدادات الشركة",-1),je=a("span",{class:"d-none"},null,-1),Ue=a("div",null,"لايوجد بيانات",-1),Le={__name:"Invoices",props:["invoices","loading","suppliers","granaries"],emits:["regetItems","filterData"],setup(s,{emit:f}){const g=p(1),y=p(1e4),D=p(null),n=p(null),$=p(null),c=p(null),x=p([{title:"رقم",key:"index"},{title:"التاريخ",key:"date"},{title:"اجمالي الكمية",key:"totalQuantitySupplied"},{title:"اجمالي القيمة",key:"companyDues"},{title:"القيمة المدفوعة",key:"paied"},{title:"القيمة المتبقية",key:"remaining"},{title:"نوع التحويل",key:"transactionType"},{title:"حالة الدفع",key:"isFullPayed"},{title:"ملاحظات",key:"notes"}]),F=[{title:"الرئيسية",disabled:!1,to:{name:"index"}},{title:"التقارير",to:{name:"reports"}},{title:"تقرير مستحقات الشركة",disabled:!0}],h=p(!1),u=p({id:"printable",popTitle:" -",extraCss:"https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.1/animate.compat.css, https://cdn.bootcdn.net/ajax/libs/hover.css/2.3.1/css/hover-min.css",extraHead:'<meta http-equiv="Content-Language"content="zh-cn"/>'});return Y(()=>g.value,t=>{f("regetItems",{page:t,limit:y.value})}),Y(()=>y.value,t=>{f("regetItems",{page:g.value,limit:t})}),K("supplierSelect",t=>{$.value=t.FromDate,c.value=t.ToDate,D.value=t.clientID,n.value=t.granaryId}),(t,d)=>{const T=m("v-icon"),I=m("v-btn"),V=m("v-breadcrumbs"),G=he,M=m("v-col"),S=Pe,o=m("v-chip"),A=m("v-row"),H=m("v-container"),J=W("print");return b(),C("div",Ge,[a("div",Se,[a("div",Ye,[R((b(),w(I,{width:"20",size:"sm",elevation:"0",color:"transparent"},{default:l(()=>[i(T,{color:"white",size:"25"},{default:l(()=>[_("mdi-printer")]),_:1})]),_:1})),[[J,e(u)]])]),i(V,{items:F,dir:"rtl",class:"pa-0 mb"},{title:l(({item:r})=>[_(v(r.title.toUpperCase()),1)]),_:1})]),i(H,{class:"page_container",fluid:""},{default:l(()=>[s.invoices?(b(),w(A,{key:0,class:"px-4 mt-1"},{default:l(()=>[i(M,{cols:"12",class:"px-0"},{default:l(()=>[i(G,{class:"mb-7",loading:s.loading,onFilterData:d[0]||(d[0]=r=>(n.value=r.granaryId,f("filterData",r))),reFilter:e(h),onRefiltered:d[1]||(d[1]=r=>h.value=!1)},null,8,["loading","reFilter"])]),_:1}),i(M,{cols:"12",class:"section_container dashboard_table pa-0",id:"printable"},{default:l(()=>[Re,s.invoices&&s.invoices.content&&s.invoices.content.length&&!s.loading?(b(),w(S,{key:0,selectedClient:e(D),selectedGranary:e(n),fromDate:e($),toDate:e(c),class:"mb-5"},null,8,["selectedClient","selectedGranary","fromDate","toDate"])):k("",!0),i(e(Z),{headers:e(x),items:s.invoices.content,loading:s.loading,"items-per-page":e(y),"onUpdate:itemsPerPage":d[2]||(d[2]=r=>q(y)?y.value=r:null),page:e(g),"onUpdate:page":d[3]||(d[3]=r=>q(g)?g.value=r:null),"items-length":s.invoices.totalElements?s.invoices.totalElements:0,"no-data-text":"لايوجد بيانات","show-current-page":"",id:"clients_payments","return-object":""},{bottom:l(()=>[je]),loading:l(()=>[i(e(ee),{type:"table-row@4"})]),"item.index":l(({item:r})=>[_(v(r.index+1),1)]),"item.isFullPayed":l(({item:r})=>[r.selectable.isFullPayed?(b(),w(o,{key:0,color:"green",label:""},{default:l(()=>[_("مدفوع بالكامل")]),_:1})):k("",!0),r.selectable.isFullPayed?k("",!0):(b(),w(o,{key:1,color:"red",label:""},{default:l(()=>[_("غير مكتمل")]),_:1}))]),"item.invoiceDate":l(({item:r})=>[a("p",null,v(e(j)(r.selectable.date).format("DD/MM/YYYY")),1)]),"item.productDetails":l(({item:r})=>[_(v(r.selectable.product.name)+" / "+v(r.selectable.productType.name),1)]),"item.totalInvoicePrice":l(({item:r})=>[_(v(r.selectable.totalPrice.toLocaleString()),1)]),"item.totalInvoicePriceAfterDiscount":l(({item:r})=>[_(v(r.selectable.totalAfterDiscount.toLocaleString()),1)]),"no-data":l(()=>[Ue]),_:1},8,["headers","items","loading","items-per-page","page","items-length"])]),_:1})]),_:1})):k("",!0)]),_:1})])}}},qe=Le,ze={class:"dashboard_clients_payments mb-10"},Qe={__name:"index",setup(s){const f=N(),g=ae(),y=te(),{clientInvoices:D}=P(f),{granaries:n}=P(y),{suppliers:$}=P(g),c=p(!1),x=p({clientID:null,granaryId:null,FromDate:null,ToDate:null}),F=async(h,u,t)=>{c.value=!0,x.value=t?{FromDate:t.FromDate,ToDate:t.ToDate,clientID:t.clientID.id,granaryId:t.granaryId.id,transactionType:t.transactionType}:{clientID:null,granaryId:null,FromDate:null,ToDate:null},await f.doGetClientInvoicesReport(h-1,u,x.value),c.value=!1};return E(()=>{D.value=[],g.doGetSuppliers(0,1e4),y.doGetGranaries(0,1e4)}),(h,u)=>{const t=qe;return b(),C("div",ze,[i(t,{invoices:e(D),loading:e(c),granaries:e(n).content,suppliers:e($).content,onRegetItems:u[0]||(u[0]=d=>F(d.page,d.limit)),onFilterData:u[1]||(u[1]=d=>F(1,1e3,d))},null,8,["invoices","loading","granaries","suppliers"])])}}};export{Qe as default};
